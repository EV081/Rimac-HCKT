{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Reglas",
  "type": "object",
  "x-dynamodb": { "partition_key": "nombre" },
  "properties": {
    "nombre": { "type": "string", "minLength": 1 },
    "descripcion": { "type": "string", "minLength": 1 },
    "categoria": {
      "type": "string",
      "enum": [
        "vacunas",
        "chequeos_pediatria",
        "tamizajes_pediatria",
        "odontologia",
        "cronicos_seguimiento",
        "funcional_mayor"
      ]
    },
    "grupo_edad": { "type": "string", "enum": ["pediatria", "adulto_mayor"] },
    "unidad": { "type": "string", "enum": ["meses", "dias"], "default": "meses" },
    "regla_activa_empieza_meses": { "type": "integer", "minimum": 0 },
    "regla_activa_termina_meses": { "type": "integer", "minimum": 0 },
    "regla_activa_empieza_dias": { "type": "integer", "minimum": 0 },
    "regla_activa_termina_dias": { "type": "integer", "minimum": 0 },
    "frecuencia_meses": { "type": "integer", "minimum": 1 }
  },
  "required": [
    "nombre",
    "descripcion",
    "categoria",
    "grupo_edad",
    "unidad",
    "frecuencia_meses"
  ],
  "allOf": [
    {
      "if": { "properties": { "unidad": { "const": "meses" } } },
      "then": {
        "required": ["regla_activa_empieza_meses", "regla_activa_termina_meses"]
      }
    },
    {
      "if": { "properties": { "unidad": { "const": "dias" } } },
      "then": {
        "required": ["regla_activa_empieza_dias", "regla_activa_termina_dias"]
      }
    }
  ],
  "additionalProperties": false
}
